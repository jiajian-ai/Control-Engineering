# 第4章 现代控制理论基础

> **课程大纲导航**: [返回课程大纲](../CONTROL_ENGINEERING_OUTLINE.md) | [上一章：PID控制](第3章_PID控制与工程调节.md) | [下一章：先进控制方法](MPC控制器说明.md)

---

## 📚 本章概述

**现代控制理论**（Modern Control Theory）诞生于20世纪60年代，是控制理论发展的第二个阶段。与经典控制理论（频域方法、传递函数）不同，现代控制理论基于**状态空间**描述，能够处理**多输入多输出（MIMO）**、**时变**和**非线性**系统。

**本章学习目标**：
1. 理解状态空间表示及其优势
2. 掌握可控性与可观性的概念和判据
3. 学会状态反馈与极点配置方法
4. 理解现代控制与经典PID的区别和联系
5. 为学习MPC等先进控制方法打下基础

**为什么学习现代控制理论？**
- 📌 处理复杂多变量系统的理论基础
- 📌 MPC、LQR等先进控制方法的数学工具
- 📌 系统分析的新视角（时域、状态）
- 📌 工程实践中越来越重要

**学习路径**：
```
经典控制理论          现代控制理论           先进控制方法
(传递函数、频域)  →  (状态空间、时域)  →  (MPC、自适应、鲁棒)
  第1-3章               第4章                 第5章
```

---

## 4.1 状态空间与线性系统

### 4.1.1 状态空间的基本概念

#### 什么是"状态"？

**状态（State）**：能够完全描述系统当前状况的最小变量集合。

**直观理解**：
- **弹簧-质量系统**：状态 = [位置, 速度]
- **RC电路**：状态 = [电容电压]
- **房间温度**：状态 = [温度]
- **倒立摆**：状态 = [小车位置, 小车速度, 杆角度, 杆角速度]

**关键特性**：
1. 知道当前状态和未来输入 → 可预测未来状态
2. 状态数量 = 系统阶数
3. 状态变量不唯一（可通过变换得到不同表示）

#### 状态空间表示

**标准形式**：

$$\begin{cases}
\dot{x}(t) = Ax(t) + Bu(t) & \text{状态方程} \\
y(t) = Cx(t) + Du(t) & \text{输出方程}
\end{cases}$$

**符号含义**：
- $x(t) \in \mathbb{R}^n$：状态向量（$n$维）
- $u(t) \in \mathbb{R}^m$：输入向量（$m$维）
- $y(t) \in \mathbb{R}^p$：输出向量（$p$维）
- $A \in \mathbb{R}^{n \times n}$：状态矩阵（系统矩阵）
- $B \in \mathbb{R}^{n \times m}$：输入矩阵（控制矩阵）
- $C \in \mathbb{R}^{p \times n}$：输出矩阵（观测矩阵）
- $D \in \mathbb{R}^{p \times m}$：前馈矩阵（通常为0）

**离散时间形式**：

$$\begin{cases}
x_{k+1} = A_d x_k + B_d u_k \\
y_k = C_d x_k + D_d u_k
\end{cases}$$

### 4.1.2 从微分方程到状态空间

#### 例1：一阶系统（RC电路）

**微分方程**：

$$RC \frac{dv_c}{dt} + v_c = v_{in}$$

**状态空间表示**：

选择状态：$x = v_c$

$$\begin{cases}
\dot{x} = -\frac{1}{RC}x + \frac{1}{RC}u \\
y = x
\end{cases}$$

矩阵形式：

$$A = -\frac{1}{RC}, \quad B = \frac{1}{RC}, \quad C = 1, \quad D = 0$$

#### 例2：二阶系统（弹簧-质量-阻尼）

**微分方程**：

$$m\ddot{y} + c\dot{y} + ky = F$$

**状态空间表示**：

选择状态：$x_1 = y$（位置），$x_2 = \dot{y}$（速度）

$$\begin{cases}
\dot{x}_1 = x_2 \\
\dot{x}_2 = -\frac{k}{m}x_1 - \frac{c}{m}x_2 + \frac{1}{m}u
\end{cases}$$

矩阵形式：

$$A = \begin{bmatrix} 0 & 1 \\ -\frac{k}{m} & -\frac{c}{m} \end{bmatrix}, \quad
B = \begin{bmatrix} 0 \\ \frac{1}{m} \end{bmatrix}, \quad
C = \begin{bmatrix} 1 & 0 \end{bmatrix}$$

#### 例3：CartPole倒立摆（本项目实现）

**状态向量**：

$$x = \begin{bmatrix} x \\ \dot{x} \\ \theta \\ \dot{\theta} \end{bmatrix} = 
\begin{bmatrix} \text{小车位置} \\ \text{小车速度} \\ \text{杆角度} \\ \text{杆角速度} \end{bmatrix}$$

**非线性动力学**（完整模型）：

$$\begin{cases}
\ddot{x} = \frac{F + ml\dot{\theta}^2\sin\theta - ml\ddot{\theta}\cos\theta}{M+m} \\
\ddot{\theta} = \frac{(M+m)g\sin\theta - \cos\theta(F + ml\dot{\theta}^2\sin\theta)}{l(M+m-m\cos^2\theta)}
\end{cases}$$

**线性化模型**（在平衡点 $\theta = 0$）：

$$A = \begin{bmatrix} 
0 & 1 & 0 & 0 \\
0 & 0 & -\frac{mg}{M} & 0 \\
0 & 0 & 0 & 1 \\
0 & 0 & \frac{(M+m)g}{Ml} & 0
\end{bmatrix}, \quad
B = \begin{bmatrix} 0 \\ \frac{1}{M} \\ 0 \\ -\frac{1}{Ml} \end{bmatrix}$$

**在本项目中的实现**：
- 完整非线性模型：`PIDController/cartpole_pid.py` 第100-112行
- 状态空间形式用于MPC：`MPCController/mpc_controller.py`

### 4.1.3 状态空间的优势

#### 与传递函数对比

| 特性 | 传递函数 | 状态空间 |
|------|---------|---------|
| **适用系统** | SISO，线性时不变 | MIMO，线性/非线性，时变 |
| **初始条件** | 不考虑（零初值） | 可处理任意初值 |
| **内部状态** | 不可见 | 完全可见 |
| **计算机实现** | 困难 | 容易（矩阵运算） |
| **物理意义** | 不直观 | 直观（状态有物理意义） |
| **控制设计** | 频域法（根轨迹等） | 时域法（状态反馈等） |

#### 状态空间的核心优势

1. **统一描述**：
   - 一套数学框架处理各种系统
   - 便于计算机编程实现

2. **完整信息**：
   - 所有内部状态可见
   - 便于状态估计和观测器设计

3. **易于扩展**：
   - 多输入多输出
   - 非线性系统
   - 时变系统

4. **现代控制基础**：
   - 最优控制（LQR）
   - 模型预测控制（MPC）
   - 自适应控制

### 4.1.4 状态空间与传递函数的转换

#### 状态空间 → 传递函数

$$G(s) = C(sI - A)^{-1}B + D$$

**示例**（一阶系统）：

$$A = -\frac{1}{\tau}, \quad B = \frac{K}{\tau}, \quad C = 1$$

$$G(s) = C(sI - A)^{-1}B = 1 \cdot \left(s + \frac{1}{\tau}\right)^{-1} \cdot \frac{K}{\tau} = \frac{K}{\tau s + 1}$$

#### 传递函数 → 状态空间

**可控标准型**（Controllable Canonical Form）

传递函数：

$$G(s) = \frac{b_n s^n + \cdots + b_1 s + b_0}{s^n + a_{n-1}s^{n-1} + \cdots + a_1 s + a_0}$$

状态空间：

$$A = \begin{bmatrix}
0 & 1 & 0 & \cdots & 0 \\
0 & 0 & 1 & \cdots & 0 \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
0 & 0 & 0 & \cdots & 1 \\
-a_0 & -a_1 & -a_2 & \cdots & -a_{n-1}
\end{bmatrix}, \quad
B = \begin{bmatrix} 0 \\ 0 \\ \vdots \\ 0 \\ 1 \end{bmatrix}$$

$$C = \begin{bmatrix} b_0 & b_1 & \cdots & b_n \end{bmatrix}$$

---

## 4.2 可控性与可观性

### 4.2.1 可控性（Controllability）

#### 定义

**可控性**：系统是否能够通过控制输入，在有限时间内将状态从任意初值转移到任意目标值。

**直观理解**：
- ✅ **可控**：我能把系统"开"到任何想要的状态
- ❌ **不可控**：有些状态"够不着"

**物理意义**：
- 汽车：可控（可以开到任何位置）
- 自由落体：不可控（只能向下，无法控制上升）

#### 可控性判据（Kalman秩判据）

**可控性矩阵**：

$$\mathcal{C} = \begin{bmatrix} B & AB & A^2B & \cdots & A^{n-1}B \end{bmatrix}$$

**判据**：

系统完全可控 $\Leftrightarrow$ $\text{rank}(\mathcal{C}) = n$

**示例1：一阶系统（可控）**

$$A = -\frac{1}{\tau}, \quad B = \frac{K}{\tau}$$

$$\mathcal{C} = [B] = \left[\frac{K}{\tau}\right]$$

$\text{rank}(\mathcal{C}) = 1 = n$ ✅ 完全可控

**示例2：二阶系统**

$$A = \begin{bmatrix} 0 & 1 \\ -\omega_n^2 & -2\zeta\omega_n \end{bmatrix}, \quad
B = \begin{bmatrix} 0 \\ 1 \end{bmatrix}$$

$$\mathcal{C} = \begin{bmatrix} B & AB \end{bmatrix} = 
\begin{bmatrix} 0 & 1 \\ 1 & -2\zeta\omega_n \end{bmatrix}$$

$\det(\mathcal{C}) = -1 \neq 0$ ✅ 完全可控

**示例3：不可控系统**

$$A = \begin{bmatrix} 1 & 0 \\ 0 & 2 \end{bmatrix}, \quad
B = \begin{bmatrix} 1 \\ 0 \end{bmatrix}$$

$$\mathcal{C} = \begin{bmatrix} 1 & 1 \\ 0 & 0 \end{bmatrix}$$

$\text{rank}(\mathcal{C}) = 1 < 2$ ❌ 不完全可控

**物理意义**：第二个状态无法被控制输入影响！

#### 可控性的工程意义

1. **控制器设计的前提**：
   - 不可控 → 无法设计状态反馈控制器
   - 只能控制可控子空间

2. **执行器配置**：
   - 检查执行器位置是否合理
   - 多执行器冗余设计

3. **系统分析**：
   - 识别系统中不受控的模态
   - 结构设计优化

### 4.2.2 可观性（Observability）

#### 定义

**可观性**：能否通过测量输出，在有限时间内确定系统的初始状态。

**直观理解**：
- ✅ **可观**：通过测量能推断出系统所有状态
- ❌ **不可观**：有些状态"看不见"

**物理意义**：
- 测量位置和速度 → 可观（知道了所有信息）
- 只测量位置 → 某些系统不可观（不知道速度）

#### 可观性判据

**可观性矩阵**：

$$\mathcal{O} = \begin{bmatrix} C \\ CA \\ CA^2 \\ \vdots \\ CA^{n-1} \end{bmatrix}$$

**判据**：

系统完全可观 $\Leftrightarrow$ $\text{rank}(\mathcal{O}) = n$

**示例1：位置测量（二阶系统）**

$$A = \begin{bmatrix} 0 & 1 \\ -k & -c \end{bmatrix}, \quad
C = \begin{bmatrix} 1 & 0 \end{bmatrix}$$

$$\mathcal{O} = \begin{bmatrix} C \\ CA \end{bmatrix} = 
\begin{bmatrix} 1 & 0 \\ 0 & 1 \end{bmatrix}$$

$\text{rank}(\mathcal{O}) = 2$ ✅ 完全可观

**物理意义**：通过测量位置的变化，可以推断出速度！

**示例2：不可观系统**

$$A = \begin{bmatrix} 1 & 1 \\ 0 & 2 \end{bmatrix}, \quad
C = \begin{bmatrix} 1 & 1 \end{bmatrix}$$

$$\mathcal{O} = \begin{bmatrix} 1 & 1 \\ 1 & 3 \end{bmatrix}$$

虽然 $\text{rank}(\mathcal{O}) = 2$，但若：

$$C = \begin{bmatrix} 1 & 0 \end{bmatrix}$$

则：

$$\mathcal{O} = \begin{bmatrix} 1 & 0 \\ 1 & 1 \end{bmatrix}$$

第二列线性相关度低，可观性差。

#### 可观性的工程意义

1. **传感器配置**：
   - 检查传感器是否充足
   - 确定最优传感器位置

2. **状态估计器设计**：
   - 可观 → 可设计观测器（Luenberger、Kalman滤波）
   - 不可观 → 无法估计所有状态

3. **故障诊断**：
   - 可观性影响故障检测能力

### 4.2.3 可控性与可观性的对偶关系

**对偶定理**：

$$(A, B) \text{ 可控} \Leftrightarrow (A^T, C^T) \text{ 可观}$$

**意义**：
- 控制器设计方法 ↔ 观测器设计方法
- 理论上对称，设计技术可以互相借鉴

---

## 4.3 状态反馈与极点配置

### 4.3.1 状态反馈控制

#### 基本思想

**控制律**：

$$u(t) = -Kx(t) + r(t)$$

其中：
- $K \in \mathbb{R}^{m \times n}$：状态反馈增益矩阵
- $r(t)$：参考输入

**闭环系统**：

$$\dot{x} = Ax + Bu = Ax + B(-Kx + r) = (A - BK)x + Br$$

**闭环状态矩阵**：

$$A_{cl} = A - BK$$

**框图**：

```
     r(t)         u(t)           x(t)
      ┌────→ ⊕ ──→ [B] ──→ ∫ ──→ [C] ──→ y(t)
      │      ↑ -      ↓      ↑
      │      │        └──[A]─┘
      │      │
      │      └──────[K]─────┘
      │           反馈
```

### 4.3.2 极点配置（Pole Placement）

#### 原理

**目标**：选择反馈增益 $K$，使闭环极点位于期望位置。

**闭环极点**：$A_{cl} = A - BK$ 的特征值

**期望特性方程**：

$$\det(sI - A_{cl}) = (s - p_1)(s - p_2)\cdots(s - p_n) = 0$$

其中 $p_1, p_2, \ldots, p_n$ 是期望极点。

#### Ackermann公式（SISO系统）

对于可控系统，存在唯一解：

$$K = \begin{bmatrix} 0 & 0 & \cdots & 0 & 1 \end{bmatrix} \mathcal{C}^{-1} \phi(A)$$

其中：
- $\mathcal{C}$ 是可控性矩阵
- $\phi(s) = (s - p_1)(s - p_2)\cdots(s - p_n)$ 是期望特性多项式
- $\phi(A)$ 是矩阵多项式

#### 极点选择准则

**时域指标**：

| 期望性能 | 极点位置 |
|---------|---------|
| **快速响应** | 远离虚轴（实部大负值） |
| **低超调** | 靠近实轴（阻尼比大） |
| **稳定** | 左半平面 |
| **振荡小** | 避免共轭复数极点 |

**经验法则**：

1. **主导极点**：
   - 选择2-3个主导极点
   - 其余极点放置在远离虚轴处（快速衰减）

2. **Butterworth配置**：
   - 极点均匀分布在半圆上
   - $p_k = \omega_c e^{j\pi(2k+n-1)/(2n)}, \quad k = 1, 2, \ldots, n$

3. **Bessel配置**：
   - 最大平坦时延
   - 适合需要线性相位的场合

#### 示例：二阶系统极点配置

**系统**：

$$A = \begin{bmatrix} 0 & 1 \\ 0 & 0 \end{bmatrix}, \quad
B = \begin{bmatrix} 0 \\ 1 \end{bmatrix}$$

（双积分器）

**期望极点**：$p_1 = -2 + 2j$, $p_2 = -2 - 2j$（$\zeta = 0.707$, $\omega_n = 2\sqrt{2}$）

**期望特性方程**：

$$\phi(s) = (s + 2 - 2j)(s + 2 + 2j) = s^2 + 4s + 8$$

**可控性矩阵**：

$$\mathcal{C} = \begin{bmatrix} 0 & 1 \\ 1 & 0 \end{bmatrix}, \quad
\mathcal{C}^{-1} = \begin{bmatrix} 0 & 1 \\ 1 & 0 \end{bmatrix}$$

**使用Ackermann公式**：

$$\phi(A) = A^2 + 4A + 8I = \begin{bmatrix} 8 & 4 \\ 4 & 8 \end{bmatrix}$$

$$K = \begin{bmatrix} 0 & 1 \end{bmatrix} \begin{bmatrix} 0 & 1 \\ 1 & 0 \end{bmatrix} \begin{bmatrix} 8 & 4 \\ 4 & 8 \end{bmatrix} = \begin{bmatrix} 8 & 4 \end{bmatrix}$$

**验证**：

$$A_{cl} = A - BK = \begin{bmatrix} 0 & 1 \\ -8 & -4 \end{bmatrix}$$

特征方程：$\det(sI - A_{cl}) = s^2 + 4s + 8$ ✅

### 4.3.3 状态反馈的局限性

#### 需要完整状态信息

**问题**：实际系统中，通常只能测量部分状态（如位置），不能直接测量所有状态（如速度、加速度）。

**解决方案**：

1. **状态观测器**（Observer / Estimator）
   - Luenberger观测器
   - Kalman滤波器

2. **输出反馈**
   - 直接使用输出设计控制器
   - 性能可能不如状态反馈

**观测器原理**：

构造动态系统：

$$\dot{\hat{x}} = A\hat{x} + Bu + L(y - \hat{y})$$

$$\hat{y} = C\hat{x}$$

其中 $L$ 是观测器增益，$\hat{x}$ 是状态估计。

#### 分离原理（Separation Principle）

**定理**：控制器和观测器可以独立设计，然后组合使用：

$$u = -K\hat{x}$$

**组合后的闭环系统**：
- 极点 = 状态反馈极点 + 观测器极点
- 各自独立设计不会相互干扰

---

## 4.4 现代控制与传统PID的区别

### 4.4.1 理论基础对比

| 方面 | 经典PID控制 | 现代状态反馈 |
|------|-----------|-------------|
| **数学基础** | 传递函数、频域 | 状态空间、时域 |
| **设计方法** | 试凑、Z-N法则 | 极点配置、最优控制 |
| **系统类型** | SISO | SISO/MIMO |
| **信息需求** | 仅输出误差 | 所有状态 |
| **理论保证** | 经验法则 | 严格数学证明 |

### 4.4.2 性能对比

#### 优势对比

**PID控制的优势**：
- ✅ 实现简单，不需要系统模型
- ✅ 仅需测量输出，无需状态观测
- ✅ 调参直观，工程经验丰富
- ✅ 对模型误差鲁棒性好
- ✅ 广泛的硬件支持

**状态反馈的优势**：
- ✅ 设计系统化，性能可预测
- ✅ 适用于多变量系统
- ✅ 可处理复杂动态和约束
- ✅ 可实现最优控制（LQR）
- ✅ 易于数字实现

#### 局限性对比

**PID控制的局限**：
- ❌ 多变量系统难以设计
- ❌ 性能依赖参数整定
- ❌ 无法处理约束
- ❌ 非线性系统效果有限

**状态反馈的局限**：
- ❌ 需要系统数学模型
- ❌ 需要所有状态信息（或观测器）
- ❌ 对模型误差敏感
- ❌ 实现复杂度高

### 4.4.3 本项目中的对比：CartPole案例

**问题描述**：倒立摆是一个经典的控制问题，系统固有不稳定。

#### PID控制策略

**实现**：`PIDController/cartpole_pid.py`

**策略1：单PID（仅控制角度）**

```python
angle_pid = PIDController(Kp=150.0, Ki=0.5, Kd=40.0)
force = angle_pid.update(theta, dt)
```

**策略2：级联PID（位置+角度）**

```python
# 外环：位置控制
desired_angle = position_pid.update(x, dt)

# 内环：角度控制
angle_pid.set_setpoint(desired_angle)
force = angle_pid.update(theta, dt)
```

**实验结果**（见 `output/cartpole_pid_control.png`）：
- 小扰动（5.7°）：可以稳定几秒
- 大扰动（11.5°）：快速失败
- **结论**：PID难以处理CartPole的强非线性和不稳定性

#### 状态反馈控制策略（理论）

**线性化模型**（在平衡点）：

$$A = \begin{bmatrix} 
0 & 1 & 0 & 0 \\
0 & 0 & -\frac{mg}{M} & 0 \\
0 & 0 & 0 & 1 \\
0 & 0 & \frac{(M+m)g}{Ml} & 0
\end{bmatrix}$$

**状态反馈**：

$$u = -K x = -\begin{bmatrix} k_1 & k_2 & k_3 & k_4 \end{bmatrix} 
\begin{bmatrix} x \\ \dot{x} \\ \theta \\ \dot{\theta} \end{bmatrix}$$

**LQR最优控制**（第5章详述）：

通过求解Riccati方程，得到最优增益 $K$，使性能指标最小：

$$J = \int_0^\infty (x^T Q x + u^T R u) dt$$

#### MPC控制策略

**实现**：`MPCController/mpc_controller.py`

**核心思想**：
1. 预测未来N步状态
2. 优化控制序列
3. 执行第一个控制
4. 滚动重复

**实验结果**（见 `output/mpc_cartpole_comparison.png`）：
- 线性MPC：4.09秒
- 非线性MPC：3.15秒
- **结论**：MPC显著优于PID，但仍需进一步改进

#### 强化学习策略（对比参考）

**特点**：
- 无需系统模型
- 自动学习最优策略
- 可以长时间保持平衡

**权衡**：
- 需要大量训练
- 黑盒特性
- 详见：`doc/PID_vs_RL_对比.md`

### 4.4.4 何时使用现代控制方法？

**使用现代控制方法的场景**：

✅ **多变量系统**
- 多输入多输出（MIMO）
- 变量间强耦合

✅ **复杂动态**
- 高阶系统
- 非最小相位系统

✅ **约束条件**
- 输入饱和
- 状态约束

✅ **性能要求高**
- 最优性能
- 快速响应

✅ **有准确模型**
- 可建立数学模型
- 参数可辨识

**继续使用PID的场景**：

✅ **简单SISO系统**
- 一阶、二阶系统
- 线性或弱非线性

✅ **模型不确定**
- 难以建模
- 参数变化大

✅ **快速部署**
- 无需复杂设计
- 调试简单

✅ **计算资源受限**
- 嵌入式系统
- 实时性要求高

✅ **工程经验丰富**
- 行业标准
- 维护方便

---

## 4.5 现代控制方法扩展

### 4.5.1 线性二次调节器（LQR）

**最优控制问题**：

$$\min_u J = \int_0^\infty (x^T Q x + u^T R u) dt$$

$$\text{subject to: } \dot{x} = Ax + Bu$$

**解**：

最优控制律：$u = -Kx$

其中：$K = R^{-1}B^T P$

$P$ 是代数Riccati方程的解：

$$A^T P + PA - PBR^{-1}B^T P + Q = 0$$

**特点**：
- 最优性保证
- 鲁棒性好（增益裕度≥6dB，相位裕度≥60°）
- 需要权重矩阵 $Q$, $R$ 调参

### 4.5.2 线性二次高斯（LQG）

**组合**：LQR（控制器）+ Kalman滤波器（观测器）

**适用场景**：
- 状态不完全可测
- 存在过程噪声和测量噪声

**结构**：

```
     r ───→ [LQR] ──u──→ [系统] ──y──→ 输出
              ↑                │
              │                ↓
              └─── [Kalman滤波] ←─── y
                    (状态估计)
```

### 4.5.3 鲁棒控制简介

**H∞控制**：
- 最小化系统对干扰的最大增益
- 对不确定性鲁棒

**滑模控制（Sliding Mode Control）**：
- 强鲁棒性
- 对参数变化不敏感
- 存在抖振问题

**μ综合**：
- 处理结构化不确定性
- 保证鲁棒稳定性和性能

---

## 4.6 本章小结

### 核心知识点回顾

#### 状态空间表示

$$\begin{cases}
\dot{x} = Ax + Bu \\
y = Cx + Du
\end{cases}$$

**优势**：MIMO、时变、非线性、计算机实现

#### 可控性与可观性

| 概念 | 矩阵 | 判据 | 意义 |
|------|------|------|------|
| **可控性** | $\mathcal{C} = [B \quad AB \quad \cdots \quad A^{n-1}B]$ | $\text{rank}(\mathcal{C}) = n$ | 能否控制所有状态 |
| **可观性** | $\mathcal{O} = [C^T \quad A^TC^T \quad \cdots \quad (A^T)^{n-1}C^T]^T$ | $\text{rank}(\mathcal{O}) = n$ | 能否估计所有状态 |

#### 状态反馈与极点配置

**控制律**：$u = -Kx$

**闭环系统**：$\dot{x} = (A - BK)x$

**极点配置**：选择 $K$ 使闭环极点在期望位置

#### 现代控制 vs PID

| 方面 | PID | 现代控制 |
|------|-----|---------|
| **适用** | 简单SISO | 复杂MIMO |
| **模型** | 不需要 | 需要 |
| **状态** | 仅输出 | 全状态 |
| **设计** | 经验 | 系统化 |
| **性能** | 良好 | 最优 |

### 本项目中的实践

| 理论内容 | 项目实现 | 文件 |
|---------|---------|------|
| **状态空间模型** | CartPole动力学 | `PIDController/cartpole_pid.py` |
| **非线性系统** | 倒立摆完整模型 | 第99-112行 |
| **状态反馈思想** | MPC控制器 | `MPCController/mpc_controller.py` |
| **PID vs 现代控制** | CartPole对比实验 | `output/cartpole_pid_control.png` |
| **多变量控制** | 4状态CartPole | MPC实验 |

### 学习建议

1. **理论学习**
   - 掌握状态空间基本概念
   - 理解可控性和可观性
   - 学习极点配置方法

2. **动手实践**
   ```bash
   # 运行CartPole PID实验
   python start.py cartpole
   
   # 运行MPC实验（现代控制应用）
   python start.py mpc
   ```

3. **对比分析**
   - 观察PID在CartPole上的局限
   - 理解为什么需要现代控制方法
   - 体会状态空间方法的优势

4. **深入思考**
   - 为什么CartPole需要全状态反馈？
   - 如何设计观测器估计不可测状态？
   - 现代控制与MPC的关系？

---

## 4.7 实战练习

### 练习1：状态空间建模

**题目**：
RLC电路，电阻R=1Ω，电感L=1H，电容C=1F。

要求：
1. 选择合适的状态变量
2. 写出状态空间表示
3. 计算传递函数

**提示**：
- 状态：电容电压 $v_C$，电感电流 $i_L$
- 基尔霍夫定律建立微分方程

### 练习2：可控性和可观性分析

**题目**：
系统：

$$A = \begin{bmatrix} -1 & 1 \\ 0 & -2 \end{bmatrix}, \quad
B = \begin{bmatrix} 0 \\ 1 \end{bmatrix}, \quad
C = \begin{bmatrix} 1 & 0 \end{bmatrix}$$

要求：
1. 判断系统是否完全可控
2. 判断系统是否完全可观
3. 解释物理意义

### 练习3：极点配置设计

**题目**：
双积分器系统（如无人机高度控制）：

$$A = \begin{bmatrix} 0 & 1 \\ 0 & 0 \end{bmatrix}, \quad
B = \begin{bmatrix} 0 \\ 1 \end{bmatrix}$$

要求：
1. 设计状态反馈使闭环极点为 $-2 \pm 2j$
2. 计算反馈增益 $K$
3. 验证闭环特性方程

**参考解答**：见4.3.2节示例

---

## 📚 扩展阅读

### 推荐教材

1. **《现代控制理论》** - 刘豹
   - 国内经典教材
   - 系统全面

2. **"Linear System Theory and Design"** - Chi-Tsong Chen
   - 国际经典
   - 理论严谨

3. **"Feedback Control of Dynamic Systems"** - Franklin, Powell & Emami-Naeini
   - 理论与实践结合
   - 大量实例

4. **《线性系统理论》** - 郑大钟
   - 数学基础扎实
   - 适合深入学习

### 在线资源

1. **MIT OCW 6.241: Dynamic Systems and Control**
   - 视频课程
   - 作业和解答

2. **Brian Douglas - State Space**
   - YouTube系列
   - 直观易懂

3. **Steve Brunton - Control Bootcamp**
   - 现代控制理论
   - Python实现

### 进阶主题

1. **非线性控制**
   - 反馈线性化
   - Lyapunov稳定性

2. **自适应控制**
   - 模型参考自适应
   - 自校正控制

3. **预测控制（MPC）**
   - 本课程第5章重点
   - 工业应用广泛

### 下一步学习

- [第5章：先进控制方法入门（MPC）](MPC控制器说明.md)
- [MPC与PID、RL对比](PID_vs_RL_对比.md)
- [CartPole实验报告](实验报告.md)

---

## 附录：常用公式速查

### 状态空间基本方程

$$\dot{x} = Ax + Bu, \quad y = Cx + Du$$

### 可控性矩阵

$$\mathcal{C} = [B \quad AB \quad A^2B \quad \cdots \quad A^{n-1}B]$$

### 可观性矩阵

$$\mathcal{O} = \begin{bmatrix} C \\ CA \\ CA^2 \\ \vdots \\ CA^{n-1} \end{bmatrix}$$

### 状态反馈

$$u = -Kx, \quad A_{cl} = A - BK$$

### 传递函数转换

$$G(s) = C(sI - A)^{-1}B + D$$

### Ackermann公式

$$K = [0 \quad 0 \quad \cdots \quad 0 \quad 1] \mathcal{C}^{-1} \phi(A)$$

---

> **导航**: [返回课程大纲](../CONTROL_ENGINEERING_OUTLINE.md) | [上一章：PID控制](第3章_PID控制与工程调节.md) | [下一章：先进控制方法](MPC控制器说明.md)

---

**最后更新**: 2025年10月30日  
**作者**: Control Engineering Lab

