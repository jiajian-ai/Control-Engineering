# PID控制器实验报告

## 实验目的

通过系统实验，深入理解PID控制器三个参数(Kp, Ki, Kd)对控制系统性能的影响，掌握PID参数调节方法。

## 实验环境

- **编程语言**: Python 3.11
- **主要库**: NumPy, Matplotlib
- **被控系统**: 一阶系统和二阶系统
- **仿真时间**: 20秒
- **采样周期**: 0.01秒 (100 Hz)

## 实验内容

### 实验1: 比例增益 Kp 的影响

**理论分析:**
- 比例项 P = Kp × e(t)
- Kp增大可以加快系统响应速度，减小稳态误差
- 但Kp过大会导致超调和振荡

**实验设置:**
- 被控系统: 一阶系统 (τ=1.0)
- Kp值: 0.5, 1.0, 2.0, 5.0, 10.0
- Ki = 0, Kd = 0

**实验结果:**

| Kp值 | 上升时间(s) | 调节时间(s) | 超调量(%) | 稳态误差 |
|------|-----------|-----------|----------|---------|
| 0.5  | 20.000    | 20.000    | 0.00     | 0.6667  |
| 1.0  | 20.000    | 20.000    | 0.00     | 0.5000  |
| 2.0  | 20.000    | 20.000    | 0.00     | 0.3333  |
| 5.0  | 20.000    | 20.000    | 0.00     | 0.1667  |
| 10.0 | 0.390     | 20.000    | 0.00     | 0.0909  |

**结论:**
1. Kp越大，系统响应越快，上升时间越短
2. Kp越大，稳态误差越小
3. 但纯P控制无法完全消除稳态误差
4. Kp过大时会产生振荡（从控制信号的初始峰值可见）

![实验1结果](experiment_1_kp_effect.png)

---

### 实验2: 积分增益 Ki 的影响

**理论分析:**
- 积分项 I = Ki × ∫e(t)dt
- Ki能够累积历史误差，消除稳态误差
- 但Ki过大会导致积分饱和和系统振荡

**实验设置:**
- 被控系统: 一阶系统 (τ=1.0) + 小噪声
- Kp = 2.0 (固定)
- Ki值: 0.0, 0.5, 1.0, 2.0, 5.0
- Kd = 0

**实验结果:**

| Ki值 | 稳态误差 | 最终积分项 |
|------|---------|----------|
| 0.0  | 0.3343  | 0.0000   |
| 0.5  | 0.0097  | 0.9745   |
| 1.0  | 0.0011  | 0.9996   |
| 2.0  | 0.0001  | 1.0000   |
| 5.0  | 0.0002  | 1.0000   |

**结论:**
1. 加入Ki后，稳态误差显著减小
2. Ki越大，消除稳态误差的速度越快
3. Ki=0时存在明显的稳态误差(33%)
4. Ki≥1.0时，稳态误差基本消除
5. Ki过大(如5.0)会导致初期超调增加

![实验2结果](experiment_2_ki_effect.png)

---

### 实验3: 微分增益 Kd 的影响

**理论分析:**
- 微分项 D = Kd × de(t)/dt
- Kd提供阻尼作用，减小超调和振荡
- 但Kd对测量噪声敏感

**实验设置:**
- 被控系统: 二阶系统 (m=1.0, c=0.3, k=1.0)
- Kp = 5.0, Ki = 1.0 (固定)
- Kd值: 0.0, 0.5, 1.0, 2.0, 5.0

**实验结果:**

| Kd值 | 超调量(%) | 最大微分项 |
|------|----------|----------|
| 0.0  | 63.67    | 0.00     |
| 0.5  | 43.11    | 50.00    |
| 1.0  | 29.80    | 100.00   |
| 2.0  | 14.76    | 200.00   |
| 5.0  | 1.34     | 500.00   |

**噪声敏感性测试:**
- Kd=0.0时，有噪声系统仍能稳定跟踪
- Kd=2.0时，噪声被放大，输出有明显抖动

**结论:**
1. Kd显著减小超调量和振荡
2. Kd从0增加到5.0，超调从64%降至1.3%
3. Kd提供预测性控制，提前响应误差变化趋势
4. Kd对高频噪声敏感，需谨慎使用

![实验3结果](experiment_3_kd_effect.png)

---

### 实验4: PID参数综合调节

**实验设置:**
测试5种不同的控制策略，在t=10s时施加扰动

**控制策略对比:**

| 策略 | Kp | Ki | Kd | 上升时间(s) | 调节时间(s) | 超调量(%) | 稳态误差 |
|------|----|----|----|-----------|-----------|---------|---------| 
| 仅P控制 | 3.0 | 0.0 | 0.0 | 0.970 | 20.000 | 25.46 | 0.2603 |
| PI控制 | 3.0 | 1.5 | 0.0 | 0.870 | 20.000 | 56.82 | 0.0741 |
| PD控制 | 3.0 | 0.0 | 1.0 | 0.870 | 20.000 | 2.13 | 0.2497 |
| 未调优PID | 5.0 | 5.0 | 0.1 | 0.620 | 20.000 | 204.20 | 0.0232 |
| **优化PID** | **3.5** | **1.8** | **1.2** | **0.690** | **16.038** | **19.33** | **0.0115** |

**各项贡献分析:**
- **P项**: 提供主要的控制力，快速响应误差
- **I项**: 逐渐累积，消除稳态误差
- **D项**: 在误差变化时产生阻尼，抑制振荡

**扰动抑制能力:**
- 仅P控制: 扰动后稳态误差最大
- PI控制: 能消除扰动引起的稳态误差，但超调大
- PD控制: 响应平稳但有稳态误差
- 优化PID: 综合性能最佳，能快速抑制扰动

![实验4结果](experiment_4_combined_tuning.png)

---

## 总结与结论

### 1. PID各参数作用总结

| 参数 | 主要作用 | 正面效果 | 负面效果 |
|------|---------|---------|---------|
| **Kp** | 比例控制 | 加快响应速度<br>减小稳态误差 | 过大导致振荡<br>无法消除稳态误差 |
| **Ki** | 积分控制 | 消除稳态误差<br>提高无差度 | 过大导致超调<br>可能积分饱和 |
| **Kd** | 微分控制 | 减小超调<br>抑制振荡<br>提高稳定性 | 对噪声敏感<br>可能放大高频干扰 |

### 2. PID调参策略

**经典调参步骤:**

1. **第一步: 调节Kp**
   - 将Ki和Kd设为0
   - 从小到大增加Kp
   - 目标: 获得较快响应但不过度振荡
   - 建议: Kp设为出现明显振荡值的50-70%

2. **第二步: 加入Ki**
   - 保持Kp不变，Kd仍为0
   - 从小到大增加Ki
   - 目标: 消除稳态误差
   - 建议: Ki不要过大，观察是否有超调

3. **第三步: 调节Kd**
   - 保持Kp和Ki不变
   - 从小到大增加Kd
   - 目标: 减小超调和振荡
   - 建议: 注意观察噪声影响

4. **第四步: 微调优化**
   - 在三个参数间权衡
   - 根据实际需求优化性能指标

### 3. 性能指标权衡

不同应用场景对性能指标的要求不同:

- **快速响应系统**: 优先考虑上升时间 → 增大Kp
- **高精度系统**: 优先考虑稳态误差 → 适当增大Ki
- **平稳系统**: 优先考虑超调量 → 适当增大Kd
- **抗干扰系统**: 平衡Ki(抗恒定扰动)和Kd(抗快变扰动)

### 4. 实践建议

1. **避免参数过大**: 所有参数都存在"过犹不及"的问题
2. **考虑执行器限制**: 设置合理的输出限幅
3. **注意积分饱和**: 必要时实现抗饱和机制
4. **处理测量噪声**: 使用Kd时考虑添加滤波
5. **系统识别**: 了解被控对象特性有助于参数选择

### 5. 实验心得

通过本次实验，我们验证了PID控制器的以下特性:

1. ✅ P控制提供快速响应但存在稳态误差
2. ✅ I控制能够消除稳态误差但可能导致超调
3. ✅ D控制能够减小超调和振荡但对噪声敏感
4. ✅ 合理搭配三个参数可以获得理想的控制性能
5. ✅ 参数调节需要在多个性能指标间权衡

---

## 参考代码

完整的实验代码包括:

- `pid_controller.py`: PID控制器核心实现
- `simulated_system.py`: 一阶和二阶系统仿真
- `pid_experiments.py`: 完整的实验代码
- `quick_demo.py`: 快速演示脚本

运行方式:
```bash
# 安装依赖
pip install -r requirements.txt

# 运行完整实验
python pid_experiments.py

# 运行快速演示
python quick_demo.py
```

---

## 附录: 数学公式

### PID控制器输出

连续时间形式:
$$u(t) = K_p e(t) + K_i \int_0^t e(\tau)d\tau + K_d \frac{de(t)}{dt}$$

离散时间形式:
$$u[k] = K_p e[k] + K_i \sum_{i=0}^k e[i] \Delta t + K_d \frac{e[k] - e[k-1]}{\Delta t}$$

其中:
- $e(t)$ = 误差 = 设定值 - 测量值
- $K_p$ = 比例增益
- $K_i$ = 积分增益  
- $K_d$ = 微分增益
- $\Delta t$ = 采样周期

---

**实验完成日期**: 2025年10月29日

**实验工具**: Python + NumPy + Matplotlib

