# 第2章 一阶/二阶系统动力学与响应

> **课程大纲导航**: [返回课程大纲](../CONTROL_ENGINEERING_OUTLINE.md) | [上一章：控制工程基础](第1章_控制工程基础.md)

---

## 📚 本章概述

在第1章中，我们学习了控制系统的基本概念和建模方法。本章将深入研究**一阶系统**和**二阶系统**的动态特性和时域响应，这两类系统是控制工程中最基础、最重要的系统模型。

**本章学习目标**：
1. 掌握一阶系统的数学模型和时域响应特性
2. 理解二阶系统的阻尼、频率等核心参数
3. 分析不同阻尼比下的系统响应特性
4. 学会通过响应曲线识别系统参数
5. 理解稳态误差的来源和分类

**为什么重点学习一阶和二阶系统？**
- 📌 绝大多数实际系统可以用一阶或二阶模型近似
- 📌 高阶系统往往可以分解为多个一阶/二阶环节的组合
- 📌 理解这两类系统是学习控制器设计的基础

---

## 2.1 一阶系统动力学

### 2.1.1 一阶系统的数学模型

**标准形式微分方程**：

$$\tau \frac{dy(t)}{dt} + y(t) = Ku(t)$$

其中：
- $y(t)$: 系统输出
- $u(t)$: 系统输入
- $\tau$: **时间常数**（Time Constant），单位：秒
- $K$: **静态增益**（Static Gain），无量纲或有单位

**传递函数**：

$$G(s) = \frac{Y(s)}{U(s)} = \frac{K}{\tau s + 1}$$

**状态空间表示**（增量形式）：

$$\dot{x} = -\frac{1}{\tau}x + \frac{K}{\tau}u$$

$$y = x$$

### 2.1.2 一阶系统的参数含义

#### 时间常数 $\tau$

**物理意义**：反映系统响应的快慢，$\tau$ 越大，系统越"迟钝"。

**定义**：
- 在阶跃输入下，系统达到稳态值的 $63.2\%$ 所需的时间
- 或者说：$t = \tau$ 时，响应达到最终值的 $1 - e^{-1} \approx 0.632$

**常见系统的时间常数**：

| 系统类型 | 典型 $\tau$ 值 | 说明 |
|---------|---------------|------|
| 温度传感器 | 1-10秒 | 热传导过程 |
| RC电路 | 毫秒-秒级 | $\tau = RC$ |
| 液位系统 | 几十秒-分钟 | 流体流动 |
| 房间温度 | 10分钟-小时 | 热容大，响应慢 |
| 电机转速 | 0.1-1秒 | 机械惯性 |

#### 静态增益 $K$

**物理意义**：稳态时输出与输入的比值。

$$K = \frac{y_{ss}}{u_{ss}} = \lim_{t \to \infty} \frac{y(t)}{u(t)}$$

**示例**：
- 加热系统：$K = 0.5$ °C/W → 每1W加热功率提升0.5°C
- 电机：$K = 100$ RPM/V → 每1V电压提升100转/分

### 2.1.3 一阶系统的阶跃响应

**输入**：单位阶跃 $u(t) = 1, \quad t \geq 0$

**输出**：

$$y(t) = K\left(1 - e^{-\frac{t}{\tau}}\right), \quad t \geq 0$$

**响应曲线特点**：

```
    y(t)
     │
   K │ ──────────────────── 稳态值 = K
     │        ╱╱╱╱╱
0.95K│      ╱           ← 95% (3τ)
0.63K│    ╱             ← 63.2% (τ)
     │  ╱
     │╱
     └──────────────────────── t
        τ  2τ  3τ  4τ  5τ
```

**关键时间点**：

| 时间 | 响应值 | 百分比 | 说明 |
|------|--------|--------|------|
| $t = \tau$ | $0.632K$ | 63.2% | 时间常数定义点 |
| $t = 2\tau$ | $0.865K$ | 86.5% | 接近稳态 |
| $t = 3\tau$ | $0.950K$ | 95.0% | 基本稳定 |
| $t = 4\tau$ | $0.982K$ | 98.2% | 2% 误差带 |
| $t = 5\tau$ | $0.993K$ | 99.3% | 几乎完全稳定 |

**工程经验法则**：
- ⏱️ **调节时间** $t_s \approx 3\tau$ （5%误差带）或 $4\tau$ （2%误差带）
- 🎯 **时间常数决定响应速度**：$\tau$ 小 → 响应快

### 2.1.4 一阶系统的其他响应

#### 脉冲响应

**输入**：单位脉冲 $\delta(t)$

**输出**：

$$h(t) = \frac{K}{\tau}e^{-\frac{t}{\tau}}, \quad t \geq 0$$

- 初始值：$h(0) = K/\tau$
- 指数衰减，速度由 $\tau$ 决定

#### 斜坡响应

**输入**：$u(t) = t$

**输出**：

$$y(t) = K\left(t - \tau + \tau e^{-\frac{t}{\tau}}\right)$$

**稳态误差**：$e_{ss} = K\tau$ （恒定滞后误差）

### 2.1.5 一阶系统实例

#### 实例1：RC电路

**电路**：
```
    ┌─── R ───┐
    │         │
  u(t)      C ─┴─ y(t)
    │         │
    └─────────┘
```

**微分方程**：

$$RC \frac{dy}{dt} + y = u$$

**参数**：
- 时间常数：$\tau = RC$
- 增益：$K = 1$

**示例数值**：
- $R = 1$ kΩ, $C = 1$ μF
- $\tau = 10^3 \times 10^{-6} = 1$ ms
- 调节时间：$t_s \approx 3$ ms

#### 实例2：房间温度控制

**物理模型**：

热量平衡方程：
$$C \frac{dT}{dt} = P - hA(T - T_a)$$

整理为标准形式：
$$\frac{C}{hA} \frac{dT}{dt} + T = \frac{P}{hA} + T_a$$

**参数**：
- 时间常数：$\tau = \frac{C}{hA}$ （热容/散热能力）
- 增益：$K = \frac{1}{hA}$

**典型数值**：
- 小房间：$\tau \approx 15$ 分钟
- 大会议室：$\tau \approx 45$ 分钟
- 温室：$\tau \approx 2$ 小时

**在本项目中的实现**：
```bash
# 运行MPC温度控制实验
python start.py mpc-temp
```
对应文件：`MPCController/mpc_temperature_control.py`

#### 实例3：液位系统

**系统**：水箱，入流速度 $Q_{in}$，出流速度 $Q_{out} = aH$（与液位成正比）

**微分方程**：

$$A \frac{dH}{dt} = Q_{in} - aH$$

整理：
$$\frac{A}{a} \frac{dH}{dt} + H = \frac{Q_{in}}{a}$$

**参数**：
- 时间常数：$\tau = \frac{A}{a}$ （横截面积/出流系数）
- 增益：$K = \frac{1}{a}$

---

## 2.2 二阶系统动力学

### 2.2.1 二阶系统的数学模型

**标准形式微分方程**：

$$\frac{d^2y}{dt^2} + 2\zeta\omega_n \frac{dy}{dt} + \omega_n^2 y = K\omega_n^2 u$$

**传递函数**（标准形式）：

$$G(s) = \frac{K\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}$$

**关键参数**：

1. **$\omega_n$：自然频率（Natural Frequency）**
   - 单位：rad/s
   - 物理意义：系统无阻尼时的振荡频率
   - 决定系统响应速度

2. **$\zeta$：阻尼比（Damping Ratio）**
   - 无量纲
   - 物理意义：阻尼程度相对临界阻尼的比值
   - 决定系统振荡特性

3. **$K$：静态增益（Static Gain）**
   - 稳态输出/输入之比

### 2.2.2 二阶系统的特征根（极点）

传递函数的特征方程：

$$s^2 + 2\zeta\omega_n s + \omega_n^2 = 0$$

**特征根**：

$$s_{1,2} = -\zeta\omega_n \pm \omega_n\sqrt{\zeta^2 - 1}$$

或写成：

$$s_{1,2} = -\sigma \pm j\omega_d$$

其中：
- **实部**：$\sigma = \zeta\omega_n$ （衰减系数）
- **虚部**：$\omega_d = \omega_n\sqrt{1-\zeta^2}$ （阻尼振荡频率）

**极点位置示意图**：

```
         虚轴 (jω)
             │
    ζ<0     │      ζ<0
  (不稳定)  │   (不稳定)
             │  ╱
         ────┼─╱──────── 实轴 (σ)
          ╲  │
    ζ>0   ╲ │      ζ>0
   (稳定)   ╲│   (稳定)
             │
             
    角度 = arccos(ζ)
```

**阻尼比决定极点分布**：
- $\zeta = 0$：极点在虚轴上（纯虚根）
- $0 < \zeta < 1$：共轭复数极点（欠阻尼）
- $\zeta = 1$：实轴上重根（临界阻尼）
- $\zeta > 1$：实轴上两个不同实根（过阻尼）

### 2.2.3 阻尼比 $\zeta$ 对系统的影响

#### 分类标准

| 阻尼比 $\zeta$ | 系统类型 | 特征根 | 响应特性 |
|---------------|---------|--------|---------|
| $\zeta = 0$ | **无阻尼** | $\pm j\omega_n$ | 等幅振荡，不收敛 |
| $0 < \zeta < 1$ | **欠阻尼** | $-\sigma \pm j\omega_d$ | 振荡衰减 |
| $\zeta = 1$ | **临界阻尼** | $-\omega_n$ (重根) | 不振荡，最快收敛 |
| $\zeta > 1$ | **过阻尼** | 两个负实根 | 不振荡，较慢收敛 |

#### 无阻尼系统（$\zeta = 0$）

**响应**：

$$y(t) = K(1 - \cos(\omega_n t))$$

**特点**：
- 🔄 持续振荡，幅值不衰减
- ⚠️ 实际系统中不稳定，工程中避免

#### 欠阻尼系统（$0 < \zeta < 1$）⭐ **最常见**

**响应**：

$$y(t) = K\left(1 - \frac{e^{-\zeta\omega_n t}}{\sqrt{1-\zeta^2}} \sin(\omega_d t + \phi)\right)$$

其中：
- $\omega_d = \omega_n\sqrt{1-\zeta^2}$：阻尼振荡频率
- $\phi = \arctan\frac{\sqrt{1-\zeta^2}}{\zeta}$：相位角

**响应曲线**：

```
    y(t)
     │
 1.3K│   ╱╲              ← 超调
     │  ╱  ╲  ╱╲
   K │─╱────╲╱──╲╱─────── 稳态值
     │╱          ╲╱
     │
     └───────────────────── t
         振荡衰减
```

**关键性能指标**：

1. **超调量（Overshoot）**：

$$M_p = e^{-\frac{\pi\zeta}{\sqrt{1-\zeta^2}}} \times 100\%$$

2. **峰值时间**：

$$t_p = \frac{\pi}{\omega_d} = \frac{\pi}{\omega_n\sqrt{1-\zeta^2}}$$

3. **调节时间**（2%误差带）：

$$t_s \approx \frac{4}{\zeta\omega_n}$$

**典型阻尼比的超调量**：

| $\zeta$ | 超调量 $M_p$ | 应用场景 |
|---------|-------------|---------|
| 0.1 | 73% | 不可接受 |
| 0.3 | 37% | 一般场合 |
| 0.5 | 16% | 常用设计 |
| 0.707 | 4.3% | 优化设计 |
| 0.9 | 0.15% | 高精度要求 |

**工程设计经验**：
- 🎯 **推荐范围**：$0.4 \leq \zeta \leq 0.8$
- 🎯 **最优值**：$\zeta \approx 0.707$ （最小积分误差）
- 🎯 **快速响应**：$\zeta \approx 0.5$
- 🎯 **低超调**：$\zeta \approx 0.8$

#### 临界阻尼系统（$\zeta = 1$）

**响应**：

$$y(t) = K\left[1 - e^{-\omega_n t}(1 + \omega_n t)\right]$$

**特点**：
- ✅ 无振荡，无超调
- ✅ 最快的无振荡响应
- 🎯 理想情况，实际难以精确实现

#### 过阻尼系统（$\zeta > 1$）

**响应**：可分解为两个指数项的组合

$$y(t) = K\left[1 - \frac{s_1 e^{s_2 t} - s_2 e^{s_1 t}}{s_1 - s_2}\right]$$

其中 $s_1, s_2$ 是两个负实根。

**特点**：
- ✅ 无振荡，无超调
- ❌ 响应速度慢于临界阻尼
- 🎯 适合要求绝对无超调的场合

### 2.2.4 自然频率 $\omega_n$ 的影响

**物理意义**：系统的"快慢"指标，$\omega_n$ 越大，响应越快。

**对性能指标的影响**：

1. **峰值时间**：$t_p \propto \frac{1}{\omega_n}$
   - $\omega_n$ 增大 → $t_p$ 减小 → 响应更快

2. **调节时间**：$t_s \approx \frac{4}{\zeta\omega_n}$
   - $\omega_n$ 增大 → $t_s$ 减小 → 更快稳定

3. **超调量**：仅与 $\zeta$ 有关，与 $\omega_n$ 无关

**示例**：固定 $\zeta = 0.5$，改变 $\omega_n$

| $\omega_n$ (rad/s) | $t_p$ (s) | $t_s$ (s) | $M_p$ |
|-------------------|-----------|-----------|-------|
| 1 | 3.63 | 8.0 | 16% |
| 2 | 1.81 | 4.0 | 16% |
| 5 | 0.73 | 1.6 | 16% |
| 10 | 0.36 | 0.8 | 16% |

**结论**：$\omega_n$ 影响速度，$\zeta$ 影响形状。

### 2.2.5 二阶系统实例

#### 实例1：弹簧-质量-阻尼系统

**物理系统**：
```
    固定墙
      ‖
      ‖╱╲╱╲╱╲  ← 弹簧 (k)
      ‖
     ┌──┐
     │  │  ← 质量块 (m)
     └──┘
      ┃┃  ← 阻尼器 (c)
      
     F(t) ← 外力
```

**牛顿第二定律**：

$$m\ddot{y} + c\dot{y} + ky = F$$

**标准化**：

$$\ddot{y} + 2\zeta\omega_n\dot{y} + \omega_n^2 y = \frac{F}{m}$$

**参数**：
- $\omega_n = \sqrt{\frac{k}{m}}$ （自然频率）
- $\zeta = \frac{c}{2\sqrt{km}}$ （阻尼比）

**示例数值**：
- $m = 1$ kg, $k = 100$ N/m, $c = 10$ Ns/m
- $\omega_n = 10$ rad/s
- $\zeta = 0.5$ （欠阻尼）

#### 实例2：RLC电路

**电路**：
```
    ┌─── R ──── L ───┐
    │                │
  u(t)             C ─┴─ y(t)
    │                │
    └────────────────┘
```

**基尔霍夫定律**：

$$LC\ddot{y} + RC\dot{y} + y = u$$

**参数**：
- $\omega_n = \frac{1}{\sqrt{LC}}$
- $\zeta = \frac{R}{2}\sqrt{\frac{C}{L}}$

#### 实例3：伺服电机位置控制

**简化模型**：

$$J\ddot{\theta} + B\dot{\theta} + K_t K_e \theta = K_t u$$

其中：
- $J$：转动惯量
- $B$：摩擦系数
- $K_t$：扭矩常数
- $K_e$：反电动势常数

**参数**：
- $\omega_n = \sqrt{\frac{K_t K_e}{J}}$
- $\zeta = \frac{B}{2\sqrt{J K_t K_e}}$

---

## 2.3 阻尼、超调与稳态误差分析

### 2.3.1 阻尼的物理本质

**阻尼**是指系统中耗散能量的机制，主要形式有：

1. **摩擦阻尼**
   - 机械系统：轴承摩擦、空气阻力
   - 阻尼力与速度成正比

2. **电阻阻尼**
   - 电路系统：电阻耗散电能
   - 阻尼与电流成正比

3. **液体阻尼**
   - 液压系统：液体粘滞阻力
   - 常用于减震器

**阻尼的作用**：
- ✅ 抑制振荡，稳定系统
- ✅ 减小超调量
- ❌ 降低响应速度（过大时）

### 2.3.2 超调量深入分析

#### 超调量的数学表达

对于欠阻尼二阶系统：

$$M_p = e^{-\frac{\pi\zeta}{\sqrt{1-\zeta^2}}} \times 100\%$$

**超调量与阻尼比的关系曲线**：

```
  Mp(%)
    │
100%│╲
    │ ╲
 50%│  ╲
    │   ╲_
 20%│     ╲__
    │        ╲___
  5%│            ╲____
  0%│                 ────────
    └────────────────────────── ζ
    0   0.3  0.5  0.7  1.0
```

#### 多次超调

欠阻尼系统会产生多次超调，第 $n$ 次峰值：

$$y_n = K(1 + (-1)^n M_p \cdot e^{-\frac{n\pi\zeta}{\sqrt{1-\zeta^2}}})$$

**衰减比**（相邻峰值之比）：

$$\delta = \frac{|y_1 - K|}{|y_2 - K|} = e^{\frac{\pi\zeta}{\sqrt{1-\zeta^2}}}$$

**通过衰减比估算阻尼比**：

$$\zeta = \frac{\ln \delta}{\sqrt{\pi^2 + (\ln \delta)^2}}$$

### 2.3.3 稳态误差分析

#### 稳态误差的定义

$$e_{ss} = \lim_{t \to \infty} [r(t) - y(t)]$$

其中：
- $r(t)$：参考输入（设定值）
- $y(t)$：系统输出

#### 误差的分类

**1. 位置误差（Position Error）**
- 对应：阶跃输入 $r(t) = R$
- 稳态误差：

$$e_{ss} = \frac{R}{1 + K_p}$$

其中 $K_p = \lim_{s \to 0} G(s)$ 是位置误差常数。

**2. 速度误差（Velocity Error）**
- 对应：斜坡输入 $r(t) = Rt$
- 稳态误差：

$$e_{ss} = \frac{R}{K_v}$$

其中 $K_v = \lim_{s \to 0} sG(s)$ 是速度误差常数。

**3. 加速度误差（Acceleration Error）**
- 对应：抛物线输入 $r(t) = \frac{1}{2}Rt^2$
- 稳态误差：

$$e_{ss} = \frac{R}{K_a}$$

其中 $K_a = \lim_{s \to 0} s^2G(s)$ 是加速度误差常数。

#### 系统类型与稳态误差

根据开环传递函数 $G(s)H(s)$ 中积分环节（$\frac{1}{s}$）的个数，将系统分为：

| 系统类型 | 开环形式 | 阶跃输入误差 | 斜坡输入误差 | 抛物线输入误差 |
|---------|---------|-------------|-------------|---------------|
| **0型** | $\frac{K}{\cdots}$ | $\frac{R}{1+K}$ | $\infty$ | $\infty$ |
| **I型** | $\frac{K}{s(\cdots)}$ | 0 | $\frac{R}{K}$ | $\infty$ |
| **II型** | $\frac{K}{s^2(\cdots)}$ | 0 | 0 | $\frac{R}{K}$ |

**结论**：
- 增加积分环节可减小稳态误差
- 但会降低系统稳定性（需要合理设计）

#### 减小稳态误差的方法

1. **增大开环增益 $K$**
   - 优点：简单有效
   - 缺点：可能导致不稳定

2. **引入积分控制（PI/PID）**
   - PID中的 $I$ 项专门消除稳态误差
   - 详见第3章

3. **复合控制**
   - 反馈+前馈结合
   - 提前补偿已知干扰

---

## 2.4 系统响应曲线识别与参数估计

### 2.4.1 从阶跃响应识别一阶系统

**已知**：系统对单位阶跃的响应曲线

**步骤**：

1. **确定稳态值 $y_{ss}$**
   - 从曲线读取最终稳定值
   - 静态增益：$K = y_{ss}$

2. **找63.2%响应点**
   - 计算 $0.632 \times y_{ss}$
   - 对应的时间即为时间常数 $\tau$

**示例**：

```
    y(t)
     │
  10 │ ──────────────────── yss = 10 → K = 10
     │        ╱╱╱
 6.32│      ·              ← 0.632×10
     │    ╱
     │  ╱
     └──────────────────── t
         2s
         ↑
        τ = 2s
```

**识别结果**：$G(s) = \frac{10}{2s+1}$

### 2.4.2 从阶跃响应识别二阶系统

**已知**：欠阻尼二阶系统的阶跃响应曲线

**步骤**：

1. **确定稳态值**：$y_{ss} → K$

2. **测量超调量**：
$$M_p = \frac{y_{max} - y_{ss}}{y_{ss}} \times 100\%$$

3. **计算阻尼比**：
$$\zeta = \frac{-\ln(M_p/100)}{\sqrt{\pi^2 + \ln^2(M_p/100)}}$$

4. **测量峰值时间** $t_p$

5. **计算自然频率**：
$$\omega_n = \frac{\pi}{t_p\sqrt{1-\zeta^2}}$$

**示例**：

```
    y(t)
     │
 1.16│   ·                ← ymax = 1.16
     │  ╱ ╲
  1.0│─╱───╲───────────── yss = 1.0
     │╱     ╲
     └─────────────────── t
          1.5s
          ↑
         tp = 1.5s
```

**计算**：
- $M_p = \frac{1.16-1.0}{1.0} = 0.16 = 16\%$
- $\zeta = 0.5$
- $\omega_n = \frac{\pi}{1.5\sqrt{1-0.5^2}} = 2.42$ rad/s

**识别结果**：
$$G(s) = \frac{5.85}{s^2 + 2.42s + 5.85}$$

### 2.4.3 图解法识别

**切线法**（用于一阶或近似一阶系统）：

1. 在响应曲线起点作切线
2. 切线与稳态值交点的时间即为 $\tau$

**两点法**（用于一阶系统）：

$$\tau = \frac{t_2 - t_1}{\ln(1-y_1/K) - \ln(1-y_2/K)}$$

选择两个测量点 $(t_1, y_1)$ 和 $(t_2, y_2)$ 代入计算。

---

## 2.5 高阶系统与主导极点

### 2.5.1 高阶系统的定义

**定义**：传递函数分母阶数 $n \geq 3$ 的系统。

$$G(s) = \frac{b_m s^m + \cdots + b_0}{a_n s^n + \cdots + a_0}, \quad n \geq 3$$

### 2.5.2 主导极点（Dominant Poles）

**定义**：对系统响应起主要作用的极点，通常是：
- 距离虚轴最近的极点
- 附近没有零点的极点

**主导极点近似**：
- 如果某对极点远离虚轴（实部很负），其影响快速衰减
- 系统可近似为低阶系统（一阶或二阶）

**示例**：

```
      虚轴
       │
       │   × ← 非主导极点（远离虚轴，衰减快）
       │
    ×  │  × ← 主导极点（靠近虚轴）
───────┼─────── 实轴
       │
       │
```

**三阶系统例子**：

$$G(s) = \frac{10}{(s+1)(s^2 + 2s + 2)} = \frac{10}{(s+1)(s+1-j)(s+1+j)}$$

- 极点：$s_1 = -1$, $s_{2,3} = -1 \pm j$
- 主导极点：$s_{2,3}$（复数极点，阻尼比 $\zeta = 0.707$）
- 近似为二阶系统分析

### 2.5.3 降阶近似

**原则**：
1. 忽略远离虚轴的实数极点（衰减快）
2. 忽略被零点抵消的极点
3. 保留主导极点

**适用条件**：
- 非主导极点实部 $> 5 \times$ 主导极点实部

---

## 2.6 本章小结

### 核心知识点回顾

#### 一阶系统

| 特性 | 公式/要点 |
|------|----------|
| **传递函数** | $G(s) = \frac{K}{\tau s + 1}$ |
| **阶跃响应** | $y(t) = K(1 - e^{-t/\tau})$ |
| **时间常数** | $\tau$ 决定响应速度 |
| **调节时间** | $t_s \approx 3\tau \sim 4\tau$ |
| **无超调** | 单调上升 |

#### 二阶系统

| 特性 | 公式/要点 |
|------|----------|
| **传递函数** | $G(s) = \frac{K\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}$ |
| **关键参数** | $\omega_n$（速度）、$\zeta$（阻尼） |
| **超调量** | $M_p = e^{-\pi\zeta/\sqrt{1-\zeta^2}}$ |
| **峰值时间** | $t_p = \pi/(\omega_n\sqrt{1-\zeta^2})$ |
| **调节时间** | $t_s \approx 4/(\zeta\omega_n)$ |
| **推荐阻尼** | $0.4 \leq \zeta \leq 0.8$ |

#### 阻尼分类

| $\zeta$ | 类型 | 特点 |
|---------|------|------|
| $= 0$ | 无阻尼 | 等幅振荡 |
| $0 < \zeta < 1$ | 欠阻尼 | 振荡衰减（最常用） |
| $= 1$ | 临界阻尼 | 最快无超调 |
| $> 1$ | 过阻尼 | 慢速无超调 |

### 性能指标对比

|  | 上升时间 | 超调量 | 调节时间 | 稳态误差 |
|--|---------|--------|---------|---------|
| **增大 $K$** | ↓ 减小 | ↑ 增大 | 影响小 | ↓ 减小 |
| **增大 $\omega_n$** | ↓ 减小 | 不变 | ↓ 减小 | 不变 |
| **增大 $\zeta$** | ↑ 增大 | ↓ 减小 | 先减后增 | 不变 |

### 本项目中的实践

| 理论内容 | 项目实现 | 文件 |
|---------|---------|------|
| **一阶系统** | 温度控制模型 | `MPCController/mpc_temperature_control.py` |
| **二阶系统** | CartPole倒立摆 | `PIDController/cartpole_pid.py` |
| **阶跃响应** | PID参数实验 | `output/experiment_*.png` |
| **超调分析** | Kp/Ki/Kd影响 | `PIDController/pid_experiments.py` |

### 学习建议

1. **理论计算**
   - 给定参数，手算响应特性
   - 预测超调量、调节时间

2. **仿真验证**
   ```bash
   # 运行PID实验，观察二阶响应
   python start.py demo
   
   # 尝试不同PID参数，观察阻尼变化
   python PIDController/pid_experiments.py
   ```

3. **参数识别**
   - 从响应曲线反推系统参数
   - 练习测量超调量、峰值时间

4. **设计思维**
   - 如何选择 $\zeta$ 和 $\omega_n$ 满足性能要求？
   - 超调与速度如何平衡？

---

## 2.7 实战练习

### 练习1：一阶系统设计

**题目**：设计一个房间温度控制系统，要求：
- 调节时间 $t_s \leq 10$ 分钟（5%误差带）
- 加热功率 1000W 能提升稳态温度 5°C

**解答**：

1. 静态增益：$K = \frac{5}{1000} = 0.005$ °C/W

2. 时间常数：$t_s = 3\tau \leq 600$s → $\tau \leq 200$s

3. 传递函数：
$$G(s) = \frac{0.005}{200s + 1}$$

### 练习2：二阶系统分析

**题目**：已知系统 $G(s) = \frac{25}{s^2 + 4s + 25}$

要求：
1. 识别 $\omega_n$ 和 $\zeta$
2. 计算超调量
3. 计算峰值时间和调节时间

**解答**：

1. 标准形式：$s^2 + 2\zeta\omega_n s + \omega_n^2 = s^2 + 4s + 25$
   - $\omega_n^2 = 25$ → $\omega_n = 5$ rad/s
   - $2\zeta\omega_n = 4$ → $\zeta = 0.4$

2. 超调量：
$$M_p = e^{-\pi \times 0.4/\sqrt{1-0.4^2}} = e^{-1.372} = 0.254 = 25.4\%$$

3. 峰值时间：
$$t_p = \frac{\pi}{\omega_n\sqrt{1-\zeta^2}} = \frac{\pi}{5\sqrt{0.84}} = 0.685 \text{ s}$$

4. 调节时间（2%）：
$$t_s = \frac{4}{\zeta\omega_n} = \frac{4}{0.4 \times 5} = 2 \text{ s}$$

### 练习3：参数识别

**题目**：阶跃响应测量数据：
- 稳态值：$y_{ss} = 8$
- 第一个峰值：$y_{max} = 10$ 出现在 $t_p = 0.5$s
- 第二个峰值：$y_2 = 8.5$

要求：识别系统参数

**解答**：

1. 增益：$K = 8$

2. 超调量：$M_p = \frac{10-8}{8} = 0.25 = 25\%$

3. 阻尼比：
$$\zeta = \frac{-\ln(0.25)}{\sqrt{\pi^2 + \ln^2(0.25)}} = 0.404$$

4. 自然频率：
$$\omega_n = \frac{\pi}{0.5\sqrt{1-0.404^2}} = 6.87 \text{ rad/s}$$

5. 传递函数：
$$G(s) = \frac{377}{s^2 + 5.55s + 47.2}$$

---

## 📚 扩展阅读

### 推荐资源

1. **经典教材**
   - 《自动控制原理》第6-7章（胡寿松）
   - 《Modern Control Engineering》Ch3-4 (Ogata)

2. **在线视频**
   - Brian Douglas: Classical Control Theory
   - MIT OCW 6.302: Feedback Systems

3. **仿真工具**
   - MATLAB: `step()`, `impulse()`, `lsim()`
   - Python: `control.step_response()`

### 相关主题

- **频域分析**：伯德图、奈奎斯特图
- **根轨迹法**：极点配置与参数设计
- **状态空间分析**：可控性、可观性

### 下一步学习

本章为第3章PID控制打下基础：
- 理解如何通过PID改变系统的 $\zeta$ 和 $\omega_n$
- 学习PID参数整定方法

➡️ [第3章：PID控制与工程调节](../README.md)

---

## 附录：常用公式速查

### 一阶系统

$$G(s) = \frac{K}{\tau s + 1}, \quad y(t) = K(1-e^{-t/\tau}), \quad t_s \approx 3\tau$$

### 二阶系统

$$G(s) = \frac{K\omega_n^2}{s^2 + 2\zeta\omega_n s + \omega_n^2}$$

$$M_p = e^{-\frac{\pi\zeta}{\sqrt{1-\zeta^2}}}, \quad t_p = \frac{\pi}{\omega_n\sqrt{1-\zeta^2}}, \quad t_s \approx \frac{4}{\zeta\omega_n}$$

### 阻尼比与超调量对照表

| $\zeta$ | 0.1 | 0.2 | 0.3 | 0.4 | 0.5 | 0.6 | 0.707 | 0.8 | 0.9 | 1.0 |
|---------|-----|-----|-----|-----|-----|-----|-------|-----|-----|-----|
| $M_p$ (%) | 73 | 53 | 37 | 25 | 16 | 9.5 | 4.3 | 1.5 | 0.15 | 0 |

---

> **导航**: [返回课程大纲](../CONTROL_ENGINEERING_OUTLINE.md) | [上一章：控制工程基础](第1章_控制工程基础.md) | [下一章：PID控制](../README.md)

---

**最后更新**: 2025年10月30日  
**作者**: Control Engineering Lab

